The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_processes` was set to a value of `2`
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
[2025-04-27 04:50:41,365] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-04-27 04:50:41,365] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /usr4/ugrad/alavaee/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /usr4/ugrad/alavaee/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
INFO 04-27 04:50:55 [__init__.py:239] Automatically detected platform cuda.
INFO 04-27 04:50:55 [__init__.py:239] Automatically detected platform cuda.
Generating train split:   0%|          | 0/7473 [00:00<?, ? examples/s]Generating train split: 100%|██████████| 7473/7473 [00:00<00:00, 175773.09 examples/s]
Generating test split:   0%|          | 0/1319 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 1319/1319 [00:00<00:00, 258047.81 examples/s]
Map:   0%|          | 0/7473 [00:00<?, ? examples/s]Map:   0%|          | 0/7473 [00:00<?, ? examples/s]Map:  35%|███▌      | 2644/7473 [00:00<00:00, 26320.11 examples/s]Map:  36%|███▌      | 2692/7473 [00:00<00:00, 26798.69 examples/s]Map:  89%|████████▊ | 6622/7473 [00:00<00:00, 26448.55 examples/s]Map:  91%|█████████ | 6776/7473 [00:00<00:00, 27050.25 examples/s]Map: 100%|██████████| 7473/7473 [00:00<00:00, 25528.37 examples/s]
Map: 100%|██████████| 7473/7473 [00:00<00:00, 26033.70 examples/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 409, in hf_raise_for_status
[rank0]:     response.raise_for_status()
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
[rank0]:     raise HTTPError(http_error_msg, response=self)
[rank0]: requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/google/gemma-3-1b-it/resolve/main/config.json

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/utils/hub.py", line 424, in cached_files
[rank0]:     hf_hub_download(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 961, in hf_hub_download
[rank0]:     return _hf_hub_download_to_cache_dir(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1068, in _hf_hub_download_to_cache_dir
[rank0]:     _raise_on_head_call_error(head_call_error, force_download, local_files_only)
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1596, in _raise_on_head_call_error
[rank0]:     raise head_call_error
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1484, in _get_metadata_or_catch_error
[rank0]:     metadata = get_hf_file_metadata(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1401, in get_hf_file_metadata
[rank0]:     r = _request_wrapper(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 285, in _request_wrapper
[rank0]:     response = _request_wrapper(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 309, in _request_wrapper
[rank0]:     hf_raise_for_status(response)
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 426, in hf_raise_for_status
[rank0]:     raise _format(GatedRepoError, message, response) from e
[rank0]: huggingface_hub.errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-680deffc-2d1d3245563d49434ee29c6e;0b49f8e1-9338-411b-bee8-03b09bb0fbc2)

[rank0]: Cannot access gated repo for url https://huggingface.co/google/gemma-3-1b-it/resolve/main/config.json.
[rank0]: Access to model google/gemma-3-1b-it is restricted. You must have access to it and be authenticated to access it. Please log in.

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/projectnb/ds543/alavaee/Documents/reasoning-slms/scripts/train_grpo.py", line 268, in <module>
[rank0]:     main()
[rank0]:   File "/projectnb/ds543/alavaee/Documents/reasoning-slms/scripts/train_grpo.py", line 203, in main
[rank0]:     model = AutoModelForCausalLM.from_pretrained(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 531, in from_pretrained
[rank0]:     config, kwargs = AutoConfig.from_pretrained(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1114, in from_pretrained
[rank0]:     config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/configuration_utils.py", line 590, in get_config_dict
[rank0]:     config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/configuration_utils.py", line 649, in _get_config_dict
[rank0]:     resolved_config_file = cached_file(
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/utils/hub.py", line 266, in cached_file
[rank0]:     file = cached_files(path_or_repo_id=path_or_repo_id, filenames=[filename], **kwargs)
[rank0]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/utils/hub.py", line 481, in cached_files
[rank0]:     raise OSError(
[rank0]: OSError: You are trying to access a gated repo.
[rank0]: Make sure to have access to it at https://huggingface.co/google/gemma-3-1b-it.
[rank0]: 401 Client Error. (Request ID: Root=1-680deffc-2d1d3245563d49434ee29c6e;0b49f8e1-9338-411b-bee8-03b09bb0fbc2)

[rank0]: Cannot access gated repo for url https://huggingface.co/google/gemma-3-1b-it/resolve/main/config.json.
[rank0]: Access to model google/gemma-3-1b-it is restricted. You must have access to it and be authenticated to access it. Please log in.
[rank1]: Traceback (most recent call last):
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 409, in hf_raise_for_status
[rank1]:     response.raise_for_status()
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
[rank1]:     raise HTTPError(http_error_msg, response=self)
[rank1]: requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/google/gemma-3-1b-it/resolve/main/config.json

[rank1]: The above exception was the direct cause of the following exception:

[rank1]: Traceback (most recent call last):
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/utils/hub.py", line 424, in cached_files
[rank1]:     hf_hub_download(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank1]:     return fn(*args, **kwargs)
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 961, in hf_hub_download
[rank1]:     return _hf_hub_download_to_cache_dir(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1068, in _hf_hub_download_to_cache_dir
[rank1]:     _raise_on_head_call_error(head_call_error, force_download, local_files_only)
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1596, in _raise_on_head_call_error
[rank1]:     raise head_call_error
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1484, in _get_metadata_or_catch_error
[rank1]:     metadata = get_hf_file_metadata(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank1]:     return fn(*args, **kwargs)
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1401, in get_hf_file_metadata
[rank1]:     r = _request_wrapper(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 285, in _request_wrapper
[rank1]:     response = _request_wrapper(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 309, in _request_wrapper
[rank1]:     hf_raise_for_status(response)
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 426, in hf_raise_for_status
[rank1]:     raise _format(GatedRepoError, message, response) from e
[rank1]: huggingface_hub.errors.GatedRepoError: 401 Client Error. (Request ID: Root=1-680deffc-3bf7db683699b9ac637ae53e;b90993a4-5791-41e7-ab56-2b4734a07767)

[rank1]: Cannot access gated repo for url https://huggingface.co/google/gemma-3-1b-it/resolve/main/config.json.
[rank1]: Access to model google/gemma-3-1b-it is restricted. You must have access to it and be authenticated to access it. Please log in.

[rank1]: The above exception was the direct cause of the following exception:

[rank1]: Traceback (most recent call last):
[rank1]:   File "/projectnb/ds543/alavaee/Documents/reasoning-slms/scripts/train_grpo.py", line 268, in <module>
[rank1]:     main()
[rank1]:   File "/projectnb/ds543/alavaee/Documents/reasoning-slms/scripts/train_grpo.py", line 203, in main
[rank1]:     model = AutoModelForCausalLM.from_pretrained(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 531, in from_pretrained
[rank1]:     config, kwargs = AutoConfig.from_pretrained(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py", line 1114, in from_pretrained
[rank1]:     config_dict, unused_kwargs = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/configuration_utils.py", line 590, in get_config_dict
[rank1]:     config_dict, kwargs = cls._get_config_dict(pretrained_model_name_or_path, **kwargs)
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/configuration_utils.py", line 649, in _get_config_dict
[rank1]:     resolved_config_file = cached_file(
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/utils/hub.py", line 266, in cached_file
[rank1]:     file = cached_files(path_or_repo_id=path_or_repo_id, filenames=[filename], **kwargs)
[rank1]:   File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/transformers/utils/hub.py", line 481, in cached_files
[rank1]:     raise OSError(
[rank1]: OSError: You are trying to access a gated repo.
[rank1]: Make sure to have access to it at https://huggingface.co/google/gemma-3-1b-it.
[rank1]: 401 Client Error. (Request ID: Root=1-680deffc-3bf7db683699b9ac637ae53e;b90993a4-5791-41e7-ab56-2b4734a07767)

[rank1]: Cannot access gated repo for url https://huggingface.co/google/gemma-3-1b-it/resolve/main/config.json.
[rank1]: Access to model google/gemma-3-1b-it is restricted. You must have access to it and be authenticated to access it. Please log in.
[rank0]:[W427 04:51:09.353981978 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W0427 04:51:12.245971 4102 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 4802 closing signal SIGTERM
E0427 04:51:12.277764 4102 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 4801) of binary: /projectnb/ivc-ml/alavaee/envs/trl/bin/python
Traceback (most recent call last):
  File "/projectnb/ivc-ml/alavaee/envs/trl/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    args.func(args)
  File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/accelerate/commands/launch.py", line 1163, in launch_command
    multi_gpu_launcher(args)
  File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/accelerate/commands/launch.py", line 792, in multi_gpu_launcher
    distrib_run.run(args)
  File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/projectnb/ivc-ml/alavaee/envs/trl/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
scripts/train_grpo.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-04-27_04:51:12
  host      : scc-211.scc.bu.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4801)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
